{"version":3,"sources":["../src/runtime.ts"],"sourcesContent":["/**\n * AliveUI Runtime\n *\n * Provides data-attribute-driven interactivity for accordion, modal, drawer,\n * dropdown, and tabs components — zero dependencies, ~2 KB.\n *\n * Usage:\n *   import { init } from '@alivecss/aliveui/runtime'\n *   init() // wire everything in document\n *   init(myRootElement) // wire a subtree\n */\n\ntype Cleanup = () => void\n\nconst cleanupRegistry = new WeakMap<Element, Cleanup[]>()\n\nfunction registerCleanup(root: Element, fn: Cleanup): void {\n  const existing = cleanupRegistry.get(root) ?? []\n  existing.push(fn)\n  cleanupRegistry.set(root, existing)\n}\n\nfunction addListener<K extends keyof HTMLElementEventMap>(\n  el: EventTarget,\n  type: K,\n  handler: (e: HTMLElementEventMap[K]) => void,\n  options?: AddEventListenerOptions,\n): Cleanup {\n  el.addEventListener(type, handler as EventListener, options)\n  return () => el.removeEventListener(type, handler as EventListener, options)\n}\n\n// ── Accordion ─────────────────────────────────────────────────────────────────\n\nfunction wireAccordion(container: Element, root: Element): void {\n  const triggers = container.querySelectorAll<HTMLElement>('[data-alive-trigger]')\n  triggers.forEach(trigger => {\n    const item = trigger.closest('[data-alive-accordion-item]') ?? trigger.parentElement\n    if (!item) return\n\n    const cleanup = addListener(trigger, 'click', () => {\n      const isOpen = item.classList.contains('is-open')\n      // Close all items if not multi-open\n      if (!container.hasAttribute('data-alive-multi')) {\n        container.querySelectorAll('[data-alive-accordion-item]').forEach(i => {\n          i.classList.remove('is-open')\n          i.querySelector('[data-alive-trigger]')?.setAttribute('aria-expanded', 'false')\n        })\n      }\n      if (!isOpen) {\n        item.classList.add('is-open')\n        trigger.setAttribute('aria-expanded', 'true')\n      }\n    })\n    registerCleanup(root, cleanup)\n  })\n}\n\n// ── Modal ─────────────────────────────────────────────────────────────────────\n\nfunction wireModal(modal: Element, root: Element): void {\n  const id = modal.getAttribute('data-alive-modal')\n  if (!id) return\n\n  // Open triggers\n  const openers = document.querySelectorAll<HTMLElement>(`[data-alive-open=\"${id}\"]`)\n  openers.forEach(opener => {\n    const cleanup = addListener(opener, 'click', () => openModal(id))\n    registerCleanup(root, cleanup)\n  })\n\n  // Close triggers inside the modal\n  modal.querySelectorAll<HTMLElement>('[data-alive-close]').forEach(closer => {\n    const cleanup = addListener(closer, 'click', () => closeModal(id))\n    registerCleanup(root, cleanup)\n  })\n\n  // Backdrop click to close (click on the modal wrapper, not the content)\n  const cleanup = addListener(modal, 'click', (e) => {\n    if (e.target === modal) closeModal(id)\n  })\n  registerCleanup(root, cleanup)\n\n  // ESC key\n  const escCleanup = addListener(document, 'keydown', (e) => {\n    if (e.key === 'Escape' && modal.classList.contains('is-open')) closeModal(id)\n  })\n  registerCleanup(root, escCleanup)\n}\n\nexport function openModal(id: string): void {\n  const modal = document.querySelector<HTMLElement>(`[data-alive-modal=\"${id}\"]`)\n  if (!modal) return\n  modal.classList.add('is-open')\n  modal.setAttribute('aria-hidden', 'false')\n  document.body.style.overflow = 'hidden'\n  // Focus first focusable element\n  const focusable = modal.querySelector<HTMLElement>(\n    'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])',\n  )\n  focusable?.focus()\n}\n\nexport function closeModal(id: string): void {\n  const modal = document.querySelector<HTMLElement>(`[data-alive-modal=\"${id}\"]`)\n  if (!modal) return\n  modal.classList.remove('is-open')\n  modal.setAttribute('aria-hidden', 'true')\n  document.body.style.overflow = ''\n}\n\n// ── Drawer ────────────────────────────────────────────────────────────────────\n\nfunction wireDrawer(drawer: Element, root: Element): void {\n  const id = drawer.getAttribute('data-alive-drawer')\n  if (!id) return\n\n  const openers = document.querySelectorAll<HTMLElement>(`[data-alive-open=\"${id}\"]`)\n  openers.forEach(opener => {\n    const cleanup = addListener(opener, 'click', () => openDrawer(id))\n    registerCleanup(root, cleanup)\n  })\n\n  drawer.querySelectorAll<HTMLElement>('[data-alive-close]').forEach(closer => {\n    const cleanup = addListener(closer, 'click', () => closeDrawer(id))\n    registerCleanup(root, cleanup)\n  })\n\n  const backdropCleanup = addListener(drawer, 'click', (e) => {\n    if (e.target === drawer) closeDrawer(id)\n  })\n  registerCleanup(root, backdropCleanup)\n\n  const escCleanup = addListener(document, 'keydown', (e) => {\n    if (e.key === 'Escape' && drawer.classList.contains('is-open')) closeDrawer(id)\n  })\n  registerCleanup(root, escCleanup)\n}\n\nexport function openDrawer(id: string): void {\n  const drawer = document.querySelector<HTMLElement>(`[data-alive-drawer=\"${id}\"]`)\n  if (!drawer) return\n  drawer.classList.add('is-open')\n  drawer.setAttribute('aria-hidden', 'false')\n  document.body.style.overflow = 'hidden'\n}\n\nexport function closeDrawer(id: string): void {\n  const drawer = document.querySelector<HTMLElement>(`[data-alive-drawer=\"${id}\"]`)\n  if (!drawer) return\n  drawer.classList.remove('is-open')\n  drawer.setAttribute('aria-hidden', 'true')\n  document.body.style.overflow = ''\n}\n\n// ── Dropdown ──────────────────────────────────────────────────────────────────\n\nfunction wireDropdown(container: Element, root: Element): void {\n  const trigger = container.querySelector<HTMLElement>('[data-alive-trigger]')\n  const menu = container.querySelector<HTMLElement>('[data-alive-dropdown-menu]')\n  if (!trigger || !menu) return\n\n  const toggleCleanup = addListener(trigger, 'click', (e) => {\n    e.stopPropagation()\n    toggleDropdown(container)\n  })\n  registerCleanup(root, toggleCleanup)\n\n  // Close on outside click\n  const outsideCleanup = addListener(document, 'click', (e) => {\n    if (!container.contains(e.target as Node)) {\n      menu.classList.remove('is-open')\n      trigger.setAttribute('aria-expanded', 'false')\n    }\n  })\n  registerCleanup(root, outsideCleanup)\n\n  // Close on ESC\n  const escCleanup = addListener(document, 'keydown', (e) => {\n    if (e.key === 'Escape' && menu.classList.contains('is-open')) {\n      menu.classList.remove('is-open')\n      trigger.setAttribute('aria-expanded', 'false')\n      trigger.focus()\n    }\n  })\n  registerCleanup(root, escCleanup)\n}\n\nexport function toggleDropdown(container: Element): void {\n  const trigger = container.querySelector<HTMLElement>('[data-alive-trigger]')\n  const menu = container.querySelector<HTMLElement>('[data-alive-dropdown-menu]')\n  if (!menu) return\n  const isOpen = menu.classList.toggle('is-open')\n  trigger?.setAttribute('aria-expanded', String(isOpen))\n  if (isOpen) {\n    // Focus first item\n    menu.querySelector<HTMLElement>('[role=\"menuitem\"], button, a')?.focus()\n  }\n}\n\n// ── Tabs ──────────────────────────────────────────────────────────────────────\n\nfunction wireTabs(container: Element, root: Element): void {\n  const tabs = container.querySelectorAll<HTMLElement>('[data-alive-tab]')\n  tabs.forEach(tab => {\n    const cleanup = addListener(tab, 'click', () => {\n      const panelId = tab.getAttribute('data-alive-tab')\n      if (!panelId) return\n      activateTab(container, panelId)\n    })\n    registerCleanup(root, cleanup)\n\n    // Keyboard navigation\n    const keyCleanup = addListener(tab, 'keydown', (e) => {\n      const allTabs = [...container.querySelectorAll<HTMLElement>('[data-alive-tab]')]\n      const idx = allTabs.indexOf(tab)\n      if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {\n        e.preventDefault()\n        allTabs[(idx + 1) % allTabs.length]?.focus()\n      } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {\n        e.preventDefault()\n        allTabs[(idx - 1 + allTabs.length) % allTabs.length]?.focus()\n      }\n    })\n    registerCleanup(root, keyCleanup)\n  })\n}\n\nfunction activateTab(container: Element, panelId: string): void {\n  // Deactivate all tabs + panels within this tabs container\n  container.querySelectorAll('[data-alive-tab]').forEach(t => {\n    t.classList.remove('is-active')\n    t.setAttribute('aria-selected', 'false')\n    t.setAttribute('tabindex', '-1')\n  })\n\n  // Find panels — look in the container, then in the whole document\n  const searchRoot = container.closest('[data-alive-tabs-panels]') ?? document\n  searchRoot.querySelectorAll('[data-alive-panel]').forEach(p => {\n    p.classList.remove('is-active')\n    p.setAttribute('aria-hidden', 'true')\n  })\n\n  // Activate the selected tab\n  const activeTab = container.querySelector<HTMLElement>(`[data-alive-tab=\"${panelId}\"]`)\n  activeTab?.classList.add('is-active')\n  activeTab?.setAttribute('aria-selected', 'true')\n  activeTab?.setAttribute('tabindex', '0')\n\n  // Activate the matching panel\n  const activePanel = searchRoot.querySelector<HTMLElement>(`[data-alive-panel=\"${panelId}\"]`)\n  activePanel?.classList.add('is-active')\n  activePanel?.setAttribute('aria-hidden', 'false')\n}\n\n// ── Public API ────────────────────────────────────────────────────────────────\n\n/**\n * Wire all data-alive-* components within `root` (defaults to document.documentElement).\n * Safe to call multiple times — existing listeners are tracked and replaced on `destroy()`.\n */\nexport function init(root: Element = document.documentElement): void {\n  // Accordion\n  root.querySelectorAll('[data-alive-accordion]').forEach(el => wireAccordion(el, root))\n\n  // Modal\n  root.querySelectorAll('[data-alive-modal]').forEach(el => wireModal(el, root))\n\n  // Drawer\n  root.querySelectorAll('[data-alive-drawer]').forEach(el => wireDrawer(el, root))\n\n  // Dropdown\n  root.querySelectorAll('[data-alive-dropdown]').forEach(el => wireDropdown(el, root))\n\n  // Tabs\n  root.querySelectorAll('[data-alive-tabs]').forEach(el => wireTabs(el, root))\n}\n\n/**\n * Remove all event listeners registered by `init(root)`.\n */\nexport function destroy(root: Element = document.documentElement): void {\n  const cleanups = cleanupRegistry.get(root) ?? []\n  cleanups.forEach(fn => fn())\n  cleanupRegistry.delete(root)\n}\n"],"mappings":"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","names":["cleanup"]}